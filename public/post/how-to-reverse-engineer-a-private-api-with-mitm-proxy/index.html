<!DOCTYPE html>
<html lang="en"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta http-equiv="cache-control" content="max-age=604800">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  
  <meta name="description" content="Disclaimer: This is for educational purposes, do not abuse this method. Developers can often struggle to find the data they need for their personal projects due to certain services locking down their API‚Äôs.
So I wanted to show you a way you can get the data you need.
What is MITM Proxy and how does it work? MITM stands for Man-in-the-Middle and mitmproxy is exactly that. It allows you to send data through a proxy that acts as a man-in-the-middle so you can read the request and responses being sent to and from the server."> 

  <title>
    
    Reverse-Engineering Private APIs with MITM Proxy
    
  </title>


  <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
  <link rel="manifest" href="/favicon/site.webmanifest">
  <link rel="me" href="https://mastodon.social/@b4uc" />
  <link rel="shortcut icon" type="image/x-icon" href="/" />
  
  
  
  <link rel="stylesheet" href="/main.1e3e82b21af9c80d11d8972c03a72b0391aea8d27ce7c89f6e6ad6bee0b1faed0008d592fd5a7676b57bb3034f7638994b62b3a24983d7265d8f2f71a3874ca0.css" integrity="sha512-Hj6Cshr5yA0R2JcsA6crA5GuqNJ858ifbmrWvuCx&#43;u0ACNWS/Vp2drV7swNPdjiZS2KzokmD1yZdjy9xo4dMoA==" />
</head>
<body a="auto">
    <main class="page-content" aria-label="Content">
        <div class="w"> <a class="house" href="/">üè†</a>



<article>
    <header>
        <h1>Reverse-Engineering Private APIs with MITM Proxy</h1>
    </header>
    
    
    
    
    

    <div class="dsclmr"><b>Disclaimer: This is for educational purposes, do not abuse this method.</b></div>
<p>Developers can often struggle to find the data they need for their personal projects due to certain services locking down their API‚Äôs.</p>
<p>So I wanted to show you a way you can get the data you need.</p>
<h2 id="what-is-mitm-proxy-and-how-does-it-work">What is MITM Proxy and how does it work?</h2>
<p><strong>MITM</strong> stands for Man-in-the-Middle and mitmproxy is exactly that. It allows you to send data through a proxy that acts as a man-in-the-middle so you can read the request and responses being sent to and from the server.</p>
<p><img src="https://securebox.comodo.com/theme/images/man-in-the-middle-attack.png" alt="MITM Diagram"></p>
<h2 id="before-we-begin">Before we begin</h2>
<p>We‚Äôll be installing this on a Macbook and capturing the data sent from an iPhone. However mitmproxy supports multiple platforms and devices. You can find out more in their <a href="https://docs.mitmproxy.org/stable/">documentation</a>.</p>
<h2 id="installation">Installation</h2>
<p>Head on over to <a href="https://mitmproxy.org">mitmproxy.org</a> and follow their installation instructions. You should be able to open mitmproxy from the terminal with:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ mitmweb
</span></span></code></pre></div><p><code>mitmweb</code> is the GUI version that should open up in a new tab once it‚Äôs running.</p>
<h2 id="with-mitmweb-running-we-can-configure-our-device">With mitmweb running we can configure our device</h2>
<p>You are going to need the local IP address of the computer running mitmproxy. You can <a href="https://www.google.com/search?q=how+to+find+local+ip+address&amp;rlz=1C5CHFA_enNZ909NZ909&amp;oq=How+to+find+local+IP+address&amp;aqs=chrome.0.0l8.3270j0j7&amp;sourceid=chrome&amp;ie=UTF-8">Google</a> how to find this on your computer.</p>
<p>On your device follow these instructions: (Detailed tutorial in video above)</p>
<ol>
<li>Enable the proxy setting on your devices connection sections.</li>
<li>Point the IP address to the local IP address of your computer</li>
<li>Set the port number to 8080</li>
<li>Authentication is not needed</li>
<li>Open your mobile browser (iPhone must be Safari)</li>
<li>Go to mitm.it</li>
<li>Click to download the certificate for your device type</li>
<li>On iPhone you then need to visit the setting page. You will be prompted about the recently downloaded certificate. Confirm the installation of the certificate there.</li>
</ol>
<p>Bypassing iPhone‚Äôs extra security</p>
<ol>
<li>Go to Settings -&gt; General -&gt; About -&gt; Certificate Trust Settings</li>
<li>Enable full trust of root certificates.</li>
</ol>
<h2 id="setup-is-done-on-to-the-fun-stuff">Setup is done, on to the fun stuff</h2>
<p>Now you should be able to open up apps on your device and you will start seeing traffic popup in mitmweb</p>
<p><img src="/img/MITM1.png" alt="img1"></p>
<p>In our example we are capturing the data being sent to <a href="https://thingiverse.com/">Thingivese</a> from the mobile app. If you look closely on the right hand side you will find the authentication header. In this header you will find the token being used to validate you as a user.</p>
<p><img src="/img/MITM2.png" alt="img2"></p>
<p>This is the token we can now use to query the API ourselves in our own personal application.</p>
<h2 id="now-try-query-the-api-yourself">Now try query the API yourself.</h2>
<p>Here we are pulling the latest listings using Axios and sending the bearer token along with it.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="font-weight:bold;text-decoration:underline">const</span> http = require(<span style="color:#666;font-style:italic">&#34;http&#34;</span>);
</span></span><span style="display:flex;"><span><span style="font-weight:bold;text-decoration:underline">const</span> Axios = require(<span style="color:#666;font-style:italic">&#34;axios&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>http
</span></span><span style="display:flex;"><span>  .createServer(<span style="font-weight:bold;font-style:italic;text-decoration:underline">function</span> (req, res) {
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold;text-decoration:underline">const</span> url = <span style="color:#666;font-style:italic">&#34;https://api.thingiverse.com/featured?page=1&amp;per_page=10&amp;return=complete&#34;</span>;
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold;text-decoration:underline">const</span> token = <span style="color:#666;font-style:italic">&#34;5a2d072366d7039776e4c35c5f32efaf&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    Axios.get(url, {
</span></span><span style="display:flex;"><span>      headers: {
</span></span><span style="display:flex;"><span>        Authorization: <span style="color:#666;font-style:italic">`token </span><span style="color:#666;font-style:italic">${</span>token<span style="color:#666;font-style:italic">}</span><span style="color:#666;font-style:italic">`</span>,
</span></span><span style="display:flex;"><span>      },
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>      .then((result) =&gt; {
</span></span><span style="display:flex;"><span>        res.setHeader(<span style="color:#666;font-style:italic">&#34;Content-Type&#34;</span>, <span style="color:#666;font-style:italic">&#34;application/json&#34;</span>);
</span></span><span style="display:flex;"><span>        res.end(JSON.stringify(result.data));
</span></span><span style="display:flex;"><span>      })
</span></span><span style="display:flex;"><span>      .<span style="font-weight:bold;text-decoration:underline">catch</span>((error) =&gt; {
</span></span><span style="display:flex;"><span>        console.error(error);
</span></span><span style="display:flex;"><span>      });
</span></span><span style="display:flex;"><span>  })
</span></span><span style="display:flex;"><span>  .listen(3000); <span style="color:#888;font-style:italic">//the server object listens on port 3000
</span></span></span></code></pre></div><h2 id="worth-noting">Worth noting</h2>
<p>This may will not work for all applications as they may use ‚ÄòCertificate Pinning‚Äô to which you‚Äôll need an Android or Jailbroken iOS device.</p>
<p>You can read more about Certificate Pinning in the docs: <a href="https://docs.mitmproxy.org/stable/concepts-certificates/#certificate-pinning">Certificate Pinning</a></p>

</article>


            <hr>
            <center>
                &#127279; <a href="https://www.gnu.org/licenses/copyleft.en.html">Copyleft</a> 2022-2023 <a
                    href="/">B4UC</a>.
                No rights reserved
                <br>
                <br>
                <div class="webring">
                    <a href="https://gnulinuxindia.org/direct.html?name=b4uc&dir=prev" alt="·êä ">·êä </a>
                    <a href="https://gnulinuxindia.org/members.html/" target="_blank"
                        alt="Visit GNU/LINUX INDIA">GNU/LINUX INDIA
                        WEBRING</a>
                    <a href="https://gnulinuxindia.org/direct.html?name=b4uc&dir=next" alt=" ·êÖ"> ·êÖ</a>
                </div>
                <br>
                <br>
                <div class="fossicons">
                    <a href="https://www.gnu.org/" target="_blank"><img src="/img/fosslinks/gnubanner.gif"
                            alt="gnu.org"></a>
                    <a href="https://www.freebsd.org/" target="_blank"><img src="/img/fosslinks/freebsd.gif"
                            alt="freebsd.org">
                    </a>
                    <a href="https://www.torproject.org/" target="_blank"><img src="/img/fosslinks/tor.gif"
                            alt="torproject.org"></a>
                    <a href="https://geti2p.net" target="_blank"><img src="/img/fosslinks/i2p.gif" alt="geti2p.net"></a>
                    <a href="https://www.getmonero.org/" target="_blank"><img src="/img/fosslinks/monero-now.gif"
                            alt="getmonero.org"></a>
                    <a href="https://wiby.me" target="_blank"><img src="/img/fosslinks/wiby.gif" alt="wiby.me"></a>
                    <a href="https://www.mozilla.org/en-US/firefox/switch/" target="_blank"><img
                            src="/img/fosslinks/same-shit.gif" alt="Ditch Chrome"></a>
                    <a href="https://www.mozilla.org/en-US/firefox/new/" target="_blank"><img
                            src="/img/fosslinks/fftake.gif" alt="Get Firefox"></a>
                    <a href="https://stallman.org/articles/on-hacking.html" target="_blank"><img
                            src="/img/fosslinks/hacker-power.gif" alt="Stallman On Hacking"></a>
                    <img src="/img/fosslinks/nocookie.gif" alt="This website uses no cookies">
                    <img src="/img/fosslinks/internetprivacy.gif" alt="Also respects your privacy">
                    <a href="https://duckduckgo.com/" target="_blank"><img src="/img/fosslinks/duckduckgo.png"
                            alt="Ditch Google"></a>
                    <a href="mailto:swapnil@iamb4uc.xyz" target="_blank"><img src="/img/fosslinks/mailput.gif"
                            alt="Email Me"></a>
                    <a href="https://www.gnu.org/gnu/linux-and-gnu.en.html" target="_blank"><img
                            src="/img/fosslinks/made_on_gnu_linux.png" alt="Freedom Land approved"></a>
                    <a href="https://vim.org" target="_blank"><img src="/img/fosslinks/vi-vim.gif"
                            alt="Written with vim"></a>
                    <a href="https://voidlinux.org" target="_blank"><img src="/img/fosslinks/voidlinux.gif"
                            alt="I use void retard"></a>
                    <a href="https://gimp.org" target="_blank"><img src="/img/fosslinks/gimp.gif"
                            alt="All graphics are edited by GIMP"></a>
                </div>
            </center>
        </div>
    </main>

</body>

</html>
